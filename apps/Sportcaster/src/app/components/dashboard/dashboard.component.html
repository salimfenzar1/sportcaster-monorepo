<div class="weather-dashboard container-fluid">
  <div class="container">
    <div class="row mb-4 justify-content-between align-items-center">
      <div class="col-auto"></div>
 <!-- Knop om voorkeuren te openen -->

 <div class="d-flex justify-content-end align-items-center mt-5 gap-3">
  <!-- Knop voor sportvoorkeuren -->
  <button
    class="btn btn-primary"
    (click)="openPreferencesModal()"
  >
    Stel sportvoorkeuren in
  </button>

  <!-- Zoekbalk met automatische suggesties -->
  <div class="search-bar-container position-relative">
    <div class="input-group">
      <input
        type="text"
        class="form-control"
        placeholder="Zoek op stad"
        [(ngModel)]="enteredLocation"
        (keyup)="onCityInput()"
        (keyup.enter)="searchWeather()"
      />
      <button
        class="btn btn-primary"
        type="button"
        (click)="searchWeather()"
      >
        <i class="bi bi-search"></i>
      </button>
    </div>

    <!-- Dropdown voor stadssuggesties -->
    <ul
      *ngIf="suggestedCities.length"
      class="list-group shadow"
      style="position: absolute; top: 100%; left: 0; width: 100%"
    >
      <li
        *ngFor="let city of suggestedCities"
        class="list-group-item list-group-item-action"
        (click)="selectCity(city)"
        tabindex="0"
      >
        {{ city.name }}
      </li>
    </ul>
  </div>
</div>


    <!-- Huidig weer -->
    <div *ngIf="currentWeather" class="row g-4 align-items-stretch">
      <div class="col-12 col-md-4">
        <div
          style="border: none !important"
          [ngClass]="currentWeatherCondition"
          class="card text-white h-100 weather-dashboard"
        >
          <div
            style="justify-content: normal !important"
            class="card-body card-body-weather text-center"
          >
            <button
              style="margin-left: auto"
              class="btn"
              (click)="refreshWeather()"
            >
              <i style="font-size: 1.4rem" class="bi bi-arrow-clockwise refreshbtn"></i>
            </button>
            <span *ngIf="isCurrentLocation" class="badge bg-success mb-2"
              >Huidige Locatie</span
            >
            <img
              [src]="
                weatherHelperService.getWeatherIcon(currentWeather.condition)
              "
              alt="Weather Icon"
              style="width: 100px; height: 100px"
            />
            <h4 class="card-title mb-2 stroke">
              {{ currentWeather.location }}
            </h4>
          </div>
        </div>
      </div>

      <div class="col-12 col-md-8">
        <div class="row g-3">
          <div
            class="col-6 col-md-4"
            *ngFor="
              let metric of [
                {
                  title: 'Temperatuur',
                  value: currentWeather.temperature,
                  icon: 'thermometer-half'
                },
                {
                  title: 'Voelt als',
                  value: currentWeather.feelsLike,
                  icon: 'thermometer-sun'
                },
                {
                  title: 'Vochtigheid',
                  value: currentWeather.humidity,
                  icon: 'droplet'
                },
                {
                  title: 'Weerconditie',
                  value: currentWeather.condition,
                  icon: 'cloud'
                },
                {
                  title: 'Windsnelheid',
                  value: currentWeather.windSpeed,
                  icon: 'wind'
                },
                {
                  title: 'Neerslag',
                  value: currentWeather.precipitation,
                  icon: 'cloud-rain'
                }
              ]
            "
          >
            <div class="card text-white bg-primary shadow h-100">
              <div class="card-body text-center">
                <i
                  class="bi bi-{{ metric.icon }} mb-3"
                  style="font-size: 1.5rem"
                ></i>
                <h6 class="card-title">{{ metric.title }}</h6>
                <p class="card-text">{{ metric.value }}</p>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

        <!-- Toggle knop voor weersvoorspelling -->
        <div class="d-flex justify-content-end mt-4">
          <button
            class="btn btn-primary"
            (click)="toggleForecast()"
          >
            {{ showForecast ? 'Verberg Weersvoorspelling' : 'Toon Weersvoorspelling' }}
          </button>
        </div>
    <!-- Weersvoorspelling -->
    <div *ngIf="showForecast" class="row g-4 mt-4">
      <div class="col-md-12">
        <div class="card text-white bg-dark shadow">
          <div class="card-header text-center">3-Uurs Weersvoorspelling</div>
          <div class="card-body">
            <div class="row g-3">
              <div
                class="col-6 col-md-4"
                *ngFor="let forecast of weatherForecast"
              >
                <div class="card text-white bg-secondary shadow h-100">
                  <div class="card-body text-center">
                    <h6 class="card-title">{{ forecast.time }}</h6>
                    <i class="bi bi-thermometer-half"></i>
                    <p class="card-text">
                      <strong>{{ forecast.temperature }}</strong>
                    </p>
                    <i class="bi bi-wind"></i>
                    <p class="card-text">
                      <strong>{{ forecast.windSpeed }}</strong>
                    </p>
                    <i class="bi bi-cloud-rain"></i>
                    <p class="card-text">
                      <strong>{{ forecast.precipitation }}</strong>
                    </p>
                  </div>
              </div>
                </div>
                </div>
                </div>
                </div>
                </div>
                </div>
   

   <!-- Voorkeuren pop-up -->
<div
class="modal fade show"
tabindex="-1"
[class.show]="showModal"
[ngStyle]="{ display: showModal ? 'block' : 'none' }"
role="dialog"
>
<div class="modal-dialog modal-dialog-centered">
  <div class="modal-content shadow-lg">
    <div class="modal-header bg-primary text-white">
      <h5 class="modal-title">Sportvoorkeuren</h5>
      <button
        type="button"
        class="btn-close text-white"
        (click)="closePreferencesModal()"
        aria-label="Close"
      ></button>
    </div>
    <div class="modal-body">
      <form>
        <div class="mb-4">
          <label for="indoor" class="form-label">Binnen of Buiten?</label>
          <select
            id="indoor"
            class="form-select"
            [(ngModel)]="preferences.indoor"
            name="indoor"
          >
            <option [value]="null">Geen voorkeur</option>
            <option [value]="true">Binnen</option>
            <option [value]="false">Buiten</option>
          </select>
        </div>
        <div class="mb-4">
          <label for="equipment" class="form-label">Benodigdheden</label>
          <input
            type="text"
            id="equipment"
            class="form-control"
            placeholder="Bijvoorbeeld: Mat, Fiets"
            [(ngModel)]="preferences.equipment"
            name="equipment"
          />
        </div>
        <div class="mb-4">
          <label for="intensity" class="form-label">Intensiteit</label>
          <select
            id="intensity"
            class="form-select"
            [(ngModel)]="preferences.intensity"
            name="intensity"
          >
            <option [value]="''">Geen voorkeur</option>
            <option value="Low">Laag</option>
            <option value="Moderate">Gemiddeld</option>
            <option value="High">Hoog</option>
          </select>
        </div>
      </form>
    </div>
    <div class="modal-footer d-flex justify-content-between">
      <button
        type="button"
        class="btn btn-outline-secondary"
        (click)="closePreferencesModal()"
      >
        Annuleer
      </button>
      <button
        type="button"
        class="btn btn-primary px-4 py-2"
        (click)="submitPreferences()"
      >
        Opslaan
      </button>
    </div>
  </div>
</div>
</div>

 <!-- Aanbevolen sporten -->
 <div *ngIf="sportsRecommendations.length > 0" class="recommendations-container mt-5">
  <h3 class="text-center text-primary mb-4">Aanbevolen Sporten</h3>
  <div class="row g-4">
    <div
      class="col-md-4"
      *ngFor="let sport of sportsRecommendations"
    >
      <div class="card shadow-lg">
        <div class="card-header bg-primary text-white text-center">
          {{ sport.name }}
        </div>
        <div class="card-body text-center">
          <p><strong>Benodigdheden:</strong> {{ sport.equipment?.join(', ') || 'Geen' }}</p>
          <p><strong>Intensiteit:</strong> {{ sport.intensity }}</p>
          <p><strong>Binnen of Buiten:</strong> {{ sport.isIndoor ? 'Binnen' : 'Buiten' }}</p>
        </div>
      </div>
    </div>
  </div>
</div>
</div>
</div>
